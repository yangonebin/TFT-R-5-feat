

# ğŸ“ˆ ì¶”ì²œ ì•Œê³ ë¦¬ì¦˜ ìƒì„¸ ì„¤ê³„ ë° ì˜ì‚¬ê²°ì • ë³´ê³ ì„œ (FinMatch)
ì£¼ì‹ê°€ê²©_AI_ì˜ˆì¸¡_ì„œë¹„ìŠ¤_(TFT-R).pdf ë¥¼ ê¼­ ë³´ì‹œëŠ” ê±¸ ê¶Œì¥ë“œë¦½ë‹ˆë‹¤.
## 1. ê°œìš” (Overview)

ë³¸ ë¬¸ì„œëŠ” FinMatch ì„œë¹„ìŠ¤ì˜ í•µì‹¬ ê¸°ëŠ¥ì¸ **'AI ì£¼ê°€ ì˜ˆì¸¡ ë° ë§¤ìˆ˜ ì‹œê·¸ë„ ì¶”ì²œ'** ì•Œê³ ë¦¬ì¦˜ì˜ ì„¤ê³„ ë° êµ¬í˜„ ê³¼ì •ì„ ê¸°ìˆ í•œë‹¤. ì´ˆê¸° LSTM ê¸°ë°˜ì˜ ì‹¤í—˜ë¶€í„° ìµœì¢… SOTA(TFT) ëª¨ë¸ ë„ì…ê¹Œì§€ì˜ **ê°€ì„¤ ìˆ˜ë¦½  ê²€ì¦  ì‹¤íŒ¨  í”¼ë²—(Pivot)** ê³¼ì •ì„ ìƒì„¸íˆ ê¸°ë¡í•˜ë©°, 5-Feature ê¸°ë°˜ì˜ TFT Regressor ëª¨ë¸ì´ ìµœì¢…ì ìœ¼ë¡œ ì„ ì •ëœ ê³µí•™ì  ê·¼ê±°ë¥¼ ì œì‹œí•œë‹¤. ìœ„ ë³´ê³ ì„œëŠ” ì£¼ì‹ê°€ê²©_AI_ì˜ˆì¸¡_ì„œë¹„ìŠ¤_(TFT-R).pdfì˜ ìš”ì•½ë³¸ì´ë‹¤.

---
## 2. ì•Œê³ ë¦¬ì¦˜ ë°œì „ ë° ì˜ì‚¬ê²°ì • ê³¼ì • (Evolution & Decision Process)

ë³¸ í”„ë¡œì íŠ¸ëŠ” ì´ 5ë‹¨ê³„ì˜ ëª¨ë¸ ê³ ë„í™” ê³¼ì •ì„ ê±°ì³, ê¸°ìˆ ì  ì§€í‘œ(RMSE)ê°€ ì•„ë‹Œ **ë¹„ì¦ˆë‹ˆìŠ¤ ê°€ì¹˜(ROI)**ë¥¼ ê·¹ëŒ€í™”í•˜ëŠ” ë°©í–¥ìœ¼ë¡œ ì˜ì‚¬ê²°ì •ì„ ìˆ˜í–‰í–ˆë‹¤.

### Phase 1: ê°€ì„¤ ìˆ˜ë¦½ ë° ë² ì´ìŠ¤ë¼ì¸ (Regression vs Classification)

* **ì´ˆê¸° ì ‘ê·¼:** ì£¼ê°€ ì˜ˆì¸¡ì„ 'ìˆ˜ì¹˜ ì˜ˆì¸¡(Regression)'ìœ¼ë¡œ ë³¼ ê²ƒì¸ê°€, 'ë°©í–¥ì„± ì˜ˆì¸¡(Classification)'ìœ¼ë¡œ ë³¼ ê²ƒì¸ê°€ì— ëŒ€í•œ A/B í…ŒìŠ¤íŠ¸ ì„¤ê³„.


* **Baseline (Regression):** MSE ì†ì‹¤ í•¨ìˆ˜ ê¸°ë°˜ LSTM. ì£¼ê°€ì˜ íë¦„ì„ ì¶”ì¢….
* **Challenger (Classification):** Binary Crossentropy ê¸°ë°˜ LSTM. ìƒìŠ¹/í•˜ë½ í™•ë¥  ì˜ˆì¸¡.
* **ì´ˆê¸° ê²°ê³¼:** 4ë°° íŒ¨ë„í‹°(4x Penalty) ì ìš© ì‹œ ë¦¬ìŠ¤í¬ íšŒí”¼ ì„±í–¥ìœ¼ë¡œ ì¸í•´ 'ê±°ë˜ ë§ˆë¹„(Trading Paralysis, ìˆ˜ìµë¥  0%)' í˜„ìƒ ë°œìƒ.


* **ì˜ì‚¬ê²°ì •:** íŒ¨ë„í‹°ë¥¼ 2ë°°ë¡œ ì™„í™”í•˜ê³ , ë°ì´í„° ì „ì²˜ë¦¬ ë°©ì‹ì„ ê°œì„ í•˜ì—¬ ì¬ì‹¤í—˜ ì§„í–‰.



### Phase 2: ê¸°ìˆ ì  ë¬¸ì œ í•´ê²° (Beast V2)

* **ë¬¸ì œì :** Classification ëª¨ë¸ í•™ìŠµ ì‹œ Gradient Vanishing ë° 0.5 í™•ë¥  ìˆ˜ë ´ í˜„ìƒ ë°œìƒ (íŒë‹¨ ìœ ë³´).


* **í•´ê²°ì±… (Beast V2):*** 
**Batch Normalization:** ê° ë ˆì´ì–´ ì§í›„ ë°°ì¹˜ ì •ê·œí™”ë¥¼ ë„ì…í•˜ì—¬ ê¸°ìš¸ê¸° ì†Œì‹¤ ë°©ì§€.


* **He Initialization & ReLU:** ê°€ì¤‘ì¹˜ ì´ˆê¸°í™” ì „ëµ ë³€ê²½ìœ¼ë¡œ ì´ˆê¸° í•™ìŠµ ì†ë„ ë° ìˆ˜ë ´ì„± ê°œì„ .




* **ì„±ê³¼:** í‰ê·  ROI 62.28% ë‹¬ì„±, T-test ê²€ì • ê²°ê³¼ íšŒê·€ ëª¨ë¸ ëŒ€ë¹„ í†µê³„ì  ìš°ìœ„ ì…ì¦.



### Phase 3: ìì‚° ë°©ì–´ ì „ëµ (Beast V3 Vault)

* **ë¬¸ì œì :** V2 ëª¨ë¸ì˜ ë†’ì€ ìˆ˜ìµë¥ (Max 135%) ëŒ€ë¹„ ë†’ì€ ë³€ë™ì„±(SD 34.71) ë¦¬ìŠ¤í¬ í™•ì¸.


* **ì „ëµ (ê¸ˆê³  ì „ëµ):** ìˆ˜ìµ ë°œìƒ ì‹œ ì¦‰ì‹œ ë³„ë„ ê³„ì¢Œ(Vault)ë¡œ ê²©ë¦¬í•˜ê³ , ì†ì‹¤ ì‹œ ë³µêµ¬í•˜ëŠ” ìê¸ˆ ê´€ë¦¬ ë¡œì§ ì¶”ê°€.


* **ì˜ì‚¬ê²°ì •:** ì•ˆì •ì„±ì€ ë†’ì•„ì¡Œìœ¼ë‚˜ í‰ê·  ROIê°€ 45.21%ë¡œ í•˜ë½í•˜ì—¬ ìˆ˜ìµ ì ì¬ë ¥ì´ í›¼ì†ë¨. ì „ëµì  íê¸° í›„ V2 ëª¨ë¸ ìœ ì§€ ê²°ì •.



### Phase 4: í„°ë‹ í¬ì¸íŠ¸ (The Turning Point) - Feature Selection

* **ë°œê²¬:** ì½”ë“œ ì‹¤ìˆ˜ë¡œ ê±°ì‹œê²½ì œ ì§€í‘œ(í™˜ìœ¨, ê¸ˆë¦¬)ì™€ ì¼ëª©ê· í˜•í‘œ ë“± 9ê°œ í”¼ì²˜ê°€ ëˆ„ë½ëœ **5-Feature(OHLCV)** íšŒê·€ ëª¨ë¸ì´ ì‹¤í–‰ë¨.


* **ì¶©ê²©ì  ê²°ê³¼:** ê¸°ì¡´ì˜ ì •êµí•œ 14-Feature ë¶„ë¥˜ ëª¨ë¸ë³´ë‹¤, ë‹¨ìˆœí•œ 5-Feature íšŒê·€ ëª¨ë¸ì´ **ROI 112.52%**ë¼ëŠ” ì••ë„ì  ì„±ê³¼ë¥¼ ê¸°ë¡.


* **ì›ì¸ ë¶„ì„:** ë³µì¡í•œ íŒŒìƒ ë³€ìˆ˜(ì¼ëª©ê· í˜•í‘œ ë“±)ê°€ ë”¥ëŸ¬ë‹ ëª¨ë¸ì—ê²ŒëŠ” ì˜¤íˆë ¤ í•™ìŠµì„ ë°©í•´í•˜ëŠ” **ë…¸ì´ì¦ˆ(Noise)**ë¡œ ì‘ìš©í–ˆìŒì„ í™•ì¸ .


* **ìµœì¢… ì˜ì‚¬ê²°ì •:** "ë°ì´í„°ëŠ” ê±°ì§“ë§í•˜ì§€ ì•ŠëŠ”ë‹¤"ëŠ” ì›ì¹™ í•˜ì—, ê¸°ì¡´ ê°€ì„¤(ë¶„ë¥˜ ìš°ì›”, ë‹¤ë³€ëŸ‰ í”¼ì²˜ ìš°ì›”)ì„ ì „ë©´ íê¸°í•˜ê³  **5-Feature ê¸°ë°˜ìœ¼ë¡œ íšŒê·€(Pivot)** ê²°ì •.



### Phase 5: ìµœì¢… ëª¨ë¸ ì„ ì • (SOTA: TFT Regressor)

* **ê³ ë„í™”:** LSTMì˜ í•œê³„(Long-term dependency)ë¥¼ ê·¹ë³µí•˜ê¸° ìœ„í•´ ì–´í…ì…˜ ë©”ì»¤ë‹ˆì¦˜ì´ ì ìš©ëœ **TFT (Temporal Fusion Transformer)** ë„ì….


* **ìµœì¢… ê²€ì¦:** TFT Regressor (5-Feat) ëª¨ë¸ì´ **í‰ê·  ROI 103.68%, ìµœê³  ROI 292.45%**ë¥¼ ê¸°ë¡í•˜ë©° ìµœì¢… ëª¨ë¸ë¡œ ì„ ì •.



---

## 3. ìµœì¢… ì•Œê³ ë¦¬ì¦˜ ìƒì„¸ ì„¤ê³„ (TFT Regressor 5-Feat)

### 3.1 ëª¨ë¸ ì•„í‚¤í…ì²˜ (Model Architecture)

ìµœì¢… ì„ ì •ëœ ëª¨ë¸ì€ **Temporal Fusion Transformer (TFT)** êµ¬ì¡°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•˜ë©°, ì‹œê³„ì—´ ë°ì´í„°ì˜ ì¥ê¸° ì˜ì¡´ì„±ê³¼ ì¤‘ìš” ë³€ê³¡ì ì„ í¬ì°©í•˜ë„ë¡ ì„¤ê³„ë˜ì—ˆë‹¤.

1. **Input Layer:** (Batch Size, 20, 5) í˜•íƒœì˜ 3D í…ì„œ ì…ë ¥.


* Look-back Window: 20ì¼ (ì•½ 1ë‹¬ ê±°ë˜ì¼).


* Features (5ê°œ): Log Returns of Open, High, Low, Close, Volume.




2. **VSN (Variable Selection Network):** ì…ë ¥ëœ 5ê°œ í”¼ì²˜ ì¤‘ í˜„ì¬ ì‹œì ì—ì„œ ê°€ì¥ ì¤‘ìš”í•œ ë³€ìˆ˜ì— ê°€ì¤‘ì¹˜ë¥¼ ë¶€ì—¬í•˜ì—¬ ì„ íƒì  í•™ìŠµ ìˆ˜í–‰.


3. **Temporal Context (LSTM):** `Stacked LSTM`ì„ í†µí•´ ì‹œê³„ì—´ì˜ ìˆœì°¨ì  íë¦„ê³¼ ë§¥ë½(Context)ì„ ì¸ì½”ë”©.


4. **Multi-Head Attention:** ê³¼ê±° 20ì¼ ì¤‘ ë¯¸ë˜ ê°€ê²© ë³€ë™ì— ê²°ì •ì  ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” íŠ¹ì • ì‹œì (Time Step)ì— ì§‘ì¤‘(Attention).


5. **GRN (Gated Residual Network):** ë¶ˆí•„ìš”í•œ ë¹„ì„ í˜• ë…¸ì´ì¦ˆë¥¼ í•„í„°ë§í•˜ê³  ì •ë³´ì˜ í†µê³¼ëŸ‰ì„ ì œì–´.


6. **Output Layer:** `Dense(1)` ë ˆì´ì–´ë¥¼ í†µí•´ ìµì¼ì˜ **ë‹¨ìˆœ ìˆ˜ìµë¥ (Simple Return)** ì˜ˆì¸¡ê°’ ì¶œë ¥.



### 3.2 ë°ì´í„° íŒŒì´í”„ë¼ì¸ (Data Pipeline)

1. **ìˆ˜ì§‘ (Ingestion):** Yahoo Finance APIë¥¼ í†µí•´ OHLCV ì›ì²œ ë°ì´í„° ìˆ˜ì§‘.


2. **ì „ì²˜ë¦¬ (Preprocessing):*** 
**ë¡œê·¸ ìˆ˜ìµë¥  ë³€í™˜:** ê°€ê²©ì˜ ë¹„ì •ìƒì„±(Non-Stationarity) ì œê±°ë¥¼ ìœ„í•´  ë³€í™˜ ì ìš©.


* **ìŠ¤ì¼€ì¼ë§:** `StandardScaler`ë¥¼ ì‚¬ìš©í•˜ì—¬ í‰ê·  0, í‘œì¤€í¸ì°¨ 1ë¡œ ì •ê·œí™” (MinMaxScalerì˜ í•œê³„ ê·¹ë³µ).




3. **ì‹œí€€ìŠ¤ ìƒì„±:** Sliding Window ë°©ì‹ì„ ì‚¬ìš©í•˜ì—¬  í˜•íƒœì˜ í•™ìŠµ ë°ì´í„°ì…‹ êµ¬ì„±.



### 3.3 í•™ìŠµ ë° ìµœì í™” ì „ëµ (Training Strategy)

* **Loss Function:** MSE (Mean Squared Error) - ì˜¤ì°¨ì˜ ì œê³±ì„ ìµœì†Œí™”í•˜ì—¬ ëŒ€í˜• ì†ì‹¤ ë°©ì§€.


* **Optimizer:** Adam (Learning Rate: 1e-4).


* **Early Stopping:** Validation Loss ê¸°ì¤€ 15íšŒ ê°œì„  ì—†ì„ ì‹œ ì¡°ê¸° ì¢…ë£Œ ë° Best Weight ë³µì›.


* **Reproducibility:** Random Seed(22) ê³ ì • ë° GPU Deterministic ì˜µì…˜ í™œì„±í™”ë¥¼ í†µí•´ ì¬í˜„ì„± í™•ë³´.


---

## 4. ì„œë¹™ ë° ì¶”ì²œ ì „ëµ (Serving & Recommendation)

### 4.1 ì¶”ì²œ ë¡œì§ (Decision Rule)

ëª¨ë¸ì´ ì˜ˆì¸¡í•œ ê°’ì€ **ìµì¼ì˜ ì˜ˆìƒ ìˆ˜ìµë¥ **ì´ë©°, ì´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì´ ì¶”ì²œ ì‹œê·¸ë„ì„ ìƒì„±í•œë‹¤.

* **BUY (ë§¤ìˆ˜):** `Predicted_Return > 0` (ì–‘ì˜ ìˆ˜ìµë¥ ì´ ì˜ˆìƒë  ë•Œ).


* **SELL (ë§¤ë„):** `Predicted_Return <= 0` (í•˜ë½ ë˜ëŠ” ë³´í•©ì´ ì˜ˆìƒë  ë•Œ).



### 4.2 ì‹œê°„ì™¸ ë‹¨ì¼ê°€ ë§¤ë§¤ ì „ëµ (After-Hours Strategy)

ì¥ì¤‘ ë³€ë™ì„±ì´ë‚˜ ê°­ìƒìŠ¹(Gap-Up) ë¦¬ìŠ¤í¬ë¥¼ íšŒí”¼í•˜ê¸° ìœ„í•´, ë°ì´í„°ê°€ í™•ì •ë˜ëŠ” ì‹œì ì— ì¦‰ì‹œ ì¶”ì²œì„ ìˆ˜í–‰í•œë‹¤.

1. **15:30:** ì •ê·œì¥ ë§ˆê° ë° ë‹¹ì¼ OHLCV ë°ì´í„° í™•ì •.


2. **15:40:** FastAPI ì„œë²„ì—ì„œ ì‹¤ì‹œê°„ ë°ì´í„° ìˆ˜ì§‘ ë° ì¶”ë¡  ìˆ˜í–‰.


3. **16:00 ~ 18:00:** 'BUY' ì‹œê·¸ë„ ë°œìƒ ì‹œ, **ì‹œê°„ì™¸ ë‹¨ì¼ê°€**ë¡œ ì„ ì·¨ë§¤ ìˆ˜í–‰.



---

## 5. ê²°ë¡  (Conclusion)

ë³¸ ì•Œê³ ë¦¬ì¦˜ ì„¤ê³„ëŠ” ì‹œì¥ì˜ ë…¸ì´ì¦ˆë¥¼ ìŠ¤ìŠ¤ë¡œ í•„í„°ë§í•˜ë©° í‰ê·  103.68%ì˜ ROIë¥¼ ë‹¬ì„±í•¨ìœ¼ë¡œì¨, ì‹¤ì œ ê¸ˆìœµ ìƒí’ˆ ì¶”ì²œ ì„œë¹„ìŠ¤ë¡œì„œì˜ ìœ íš¨ì„±ì„ ì…ì¦í•˜ì˜€ë‹¤. ë‹¤ë§Œ, ì±…ì„ì€ ì „ì ìœ¼ë¡œ íˆ¬ììì—ê²Œ ìˆìœ¼ë¯€ë¡œ ë°°í¬ëŠ” í•˜ì§€ ì•„ë‹ˆí•œë‹¤. 